{"ts":1342814586465,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"DNS\n---\n\nFirst off, add a DNS record (either fully qualified domains, or subdomains) for each service you'd like to run, all pointed to the IP address of your HTTP proxy. Note that it may take a while for your updates to propagate, so don't despair if things aren't as expected right away.\n\nFirewalls\n---------\n\nIf you wish to keep your services behind a firewall, such as iptables, you'll need to make sure to bind your services to an internal interface, like so: \n\n```service.start(port, \"localhost\")```.\n\nNon-root\n--------\n\nIt's never a good practice to run network services as the root user but you will run into operating system restriction of available ports when running as a non-root account in many environments.\n\nFor the example proxy provided we use port 8080 on the internal interface to get around this restriction. \n\nYou'll need to do something to redirect traffic from port 80 on the external interface to our proxy on port 8080. \n\nIf your system has ```iptables``` you can do something like this: \n\n```iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 8080```\n\nRunning as a service\n--------------------\n\nWhat happens when you want to make sure your proxy stays up, no matter what?\n\nThere are lots of options here, including the excellent Forever:\n\n```\n$ npm install forever\n$ forever start service.js\n```\n\nIf you're working in a Debian-based environment, add a file called ```proxy.conf``` to ```/etc/init/``` containing something like this:\n\n```\ndescription \"Reverse HTTP Proxy\"\nauthor      \"Your Name\"\n \nstart on started mountall\nstop on shutdown\n\nrespawn\nrespawn limit 99 5\n \nscript\n    export HOME=\"/home/node\"\n    exec sudo -u node /usr/bin/node /home/node/service.js >> /home/node/node.log 2>&1\nend script\n```\n\nYour proxy will now be started at boot, and can also be controlled like so:\n\n```\nstart proxy\nstop proxy\nrestart proxy\n```"]],"start1":0,"start2":0,"length1":0,"length2":1882}]],"length":1882}
